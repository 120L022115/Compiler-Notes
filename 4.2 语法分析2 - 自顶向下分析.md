#### 4.2 语法分析2 - 自顶向下分析（递归下降分析）

1. 采用最左推导：逐Token扫描，根据输入流的终结符，选择候选式。

2. 自顶向下分析的实现方式：递归下降分析，一个非终结符具有1个过程，从S过程开始，递归调用，直到扫描完成或出错。

   ```c++
   	void s(){
       	选择一个产生式S -> X_i
   		for(i in X_i){
               if(X_i是终结符){
                   if(X_i==当前Token){
                       //输入指针移动并取下一个Token
                   }else{
                       //报错，不接受
                   }
               }else{//不是终结符
                   X_i() //执行对应过程
               }
           }
   	}
   ```

3. 对于CFG文法，自顶向下分析可能存在的问题——解决办法：

   1. 公共前缀导致回溯——提取左公因子式
   2. 发生左递归导致无限循环——消除左递归
   3. 其他问题：消除后仍然可能回溯

4. 左递归：$A\Rightarrow^+Aa$

   1. 直接左递归：$A\rightarrow^+Aa$
   2. 间接左递归：$ {A\Rightarrow^+Ba}\\{B\Rightarrow^+Ab}$ $\iff$ $A\Rightarrow^+Aba$

5. 消除左递归（变为右递归）

   1. 消除直接左递归：引入新变元B
      $A\rightarrow A\alpha_i|\beta_j$$\iff$$ A→\beta_i|β_iB\\B→α_i|α_iB$$\iff$$ A→β_iB\\B→\varepsilon|α_iB$
   2. 消除间接左递归：重命名为$A_i$
      通过代入使产生式形如$A_i\rightarrow A_j\alpha\\A_i\rightarrow a\alpha$ $(i\le j)$
      然后再消除直接左递归再重新代入

6. 消除左递归的算法

7. 提取左公因子式：创建新的产生式，将原有产生式的**非公共部分**放入新的产生式右部并替换为新的非终结符。
